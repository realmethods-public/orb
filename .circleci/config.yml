version: 2.1

orbs:
  realmethods: realmethods/realmethods@dev:0.0.3

jobs:
  generate-app:
  
    docker:
      - image: 'circleci/node:8.12.0-jessie'

    steps:
      - realmethods/initialize:
          api-token: sny6iLHAH4SMJU1F

##################################################################
## Multiple app generations are included to give an example of
## usage for each supported technology stacks. Only include the 
## section(s) you need.
##
## Learn more about configuration files and settings at:
## https://www.realmethods.com/cli.html#config-files
###################################################################

 
## Spark Microweb using MySQL
      - realmethods/generate_app:
          generation-yaml-file: "samples/yamls/generate-sparkmicroweb.yml"
          git-params-file: "samples/git/test.git.yml"
          app-options-file: "samples/options/SparkMicroWeb.options.json"
          model-identifier: "samples/models/reference_management.xmi"

#################################################################
# In order to deploy the generated Lambda functions, the key vars 
# (USER_AWS_ACCESSKEY and USER_AWS_SECRETKEY) are 
# read in as env vars for the current project. 
# Learn how to add these env vars at https://circleci.com/docs/2.0/env-vars/#setting-an-environment-variable-in-a-project 
#################################################################
            
## AWS Lambda using MySQL          
      - realmethods/generate_app:
          generation-yaml-file: "samples/yamls/generate-lambdacore.yml"
          git-params-file: "samples/git/test.git.yml"
          app-options-file: "samples/options/Lambda.options.json"
          model-identifier: "samples/models/reference_management.xmi"
           
## AWS Lambda using MongoDB
      - realmethods/generate_app:
          generation-yaml-file: "samples/yamls/generate-lambdanosql.yml"
          git-params-file: "samples/git/test.git.yml"
          app-options-file: "samples/options/LambdaNoSQL.options.json"
          model-identifier: "samples/models/reference_management.xmi"
           
 
workflows:
  version: 2
  app-gen-workflow:
    jobs:
      - generate-app